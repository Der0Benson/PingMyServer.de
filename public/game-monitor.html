<!doctype html>
<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      data-i18n-content="meta.game_monitor.description"
      content="Game Monitor für Minecraft: Serverstatus, Ping, Spielerzahlen und weitere Live-Metriken."
    />
    <meta name="robots" content="noindex, nofollow" />
    <meta name="googlebot" content="noindex, nofollow" />
    <meta name="theme-color" content="#0b0f14" />
    <link rel="icon" type="image/png" href="/assets/pingmyserverlogo.png" />
    <link rel="apple-touch-icon" href="/assets/pingmyserverlogo.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <title data-i18n="meta.game_monitor.title">Game Monitor - PingMyServer</title>
    <link rel="stylesheet" href="/assets/styles.css" />
    <link rel="stylesheet" href="/assets/game-monitor.css" />
    <link rel="stylesheet" href="/assets/i18n.css" />
    <link rel="stylesheet" href="/assets/footer.css" />
  </head>
  <body>
    <div class="app">
      <aside class="sidebar">
        <a
          class="brand brand-link"
          href="/"
          data-i18n-aria-label="common.aria.home"
          aria-label="PingMyServer Startseite"
        >
          <img class="brand-logo" src="/assets/pingmyserverlogo.png" alt="PingMyServer" />
          <span class="brand-name">PingMyServer.de</span>
        </a>
        <nav class="side-nav">
          <a href="/app" data-i18n="common.monitoring">Monitoring</a>
          <a href="/monitors" data-i18n="common.monitors">Monitore</a>
          <a href="/incidents" data-i18n="common.incidents">Vorfälle</a>
          <a href="/notifications" data-i18n="common.notifications">Benachrichtigungen</a>
          <a class="active" href="/game-monitor" data-i18n="common.game_monitor">Game Monitor</a>
          <a href="/connections" data-i18n="common.connections">Connections</a>
          <a href="/owner" data-owner-link hidden data-i18n="common.owner_ops">Owner Ops</a>
          <a href="/status" target="_blank" rel="noreferrer" data-i18n="common.status_page">Statusseite</a>
        </nav>
        <div class="side-footer">
          <a
            class="user-pill profile-link"
            href="/connections"
            data-i18n-aria-label="common.aria.profile_settings"
            aria-label="Connections und Kontoeinstellungen"
          >
            <span class="avatar small">U</span>
            <span class="muted" id="current-user-email" data-i18n="common.signed_in">eingeloggt</span>
          </a>
          <div class="lang-picker">
            <span class="sr-only" data-i18n="common.language">Sprache</span>
            <details class="lang-menu">
              <summary class="lang-summary" data-i18n-aria-label="common.language" aria-label="Language">
                <img class="lang-flag-img" data-lang-block="de" src="/assets/flags/de.svg" alt="" aria-hidden="true" />
                <img
                  class="lang-flag-img"
                  data-lang-block="en"
                  src="/assets/flags/gb.svg"
                  alt=""
                  aria-hidden="true"
                  hidden
                />
              </summary>
              <div class="lang-options" data-i18n-aria-label="common.language" aria-label="Language">
                <button class="lang-option" type="button" data-set-lang="de" data-i18n-aria-label="common.lang_de" aria-label="Deutsch">
                  <img class="lang-flag-img" src="/assets/flags/de.svg" alt="" aria-hidden="true" />
                </button>
                <button class="lang-option" type="button" data-set-lang="en" data-i18n-aria-label="common.lang_en" aria-label="English">
                  <img class="lang-flag-img" src="/assets/flags/gb.svg" alt="" aria-hidden="true" />
                </button>
              </div>
            </details>
          </div>
          <button class="btn ghost" id="logout-btn" type="button" data-i18n="common.logout">Abmelden</button>
        </div>
      </aside>

      <div class="content">
        <div class="page">
          <div class="crumb" data-i18n="common.game_monitor">Game Monitor</div>
          <header class="topbar">
            <div class="title-block">
              <img class="logo-mark" src="/assets/pingmyserverlogo.png" alt="" aria-hidden="true" />
              <div>
                <div class="title" data-i18n="game_monitor.title">Game Monitor</div>
                <div class="subtitle" data-i18n="game_monitor.sub">Game Server live tracken: Ping, Spieler und mehr</div>
              </div>
            </div>
            <div class="top-actions">
              <button class="btn primary" id="add-game-btn" type="button">Neues Spiel hinzufügen</button>
              <button class="btn ghost" id="refresh-btn" type="button" data-i18n="common.refresh">Aktualisieren</button>
            </div>
          </header>

          <main class="game-monitor-page">
            <div class="game-monitor-layout">
              <section class="card game-list-card">
                <div class="card-title" data-i18n="game_monitor.games.title">Spiele</div>
                <p class="muted game-list-copy">Wähle ein verbundenes Spiel oder füge ein neues über das Modal hinzu.</p>
                <div class="game-list" id="game-list" aria-label="Spiele">
                  <div class="empty-state">
                    <div class="title">Keine Spiele konfiguriert.</div>
                    <div class="muted">Starte mit "Neues Spiel hinzufügen".</div>
                  </div>
                </div>
              </section>

              <section class="card wide game-overview-card">
                <header class="overview-head">
                  <div>
                    <div class="card-title" id="overview-game-label">Ausgewähltes Spiel</div>
                    <h2 class="overview-title" id="overview-title">Minecraft</h2>
                    <p class="muted overview-sub" id="overview-sub">Verbindungsdaten und Live-Metriken.</p>
                  </div>
                  <div class="overview-head-actions">
                    <span class="status-pill loading" id="overview-status-pill">Wird aktualisiert</span>
                  </div>
                </header>

                <div class="overview-kpis">
                  <article class="kpi-card">
                    <div class="card-title">Verbindungsstatus</div>
                    <div class="metric" id="kpi-health">-</div>
                    <div class="muted" id="kpi-health-sub">Noch keine Daten</div>
                  </article>
                  <article class="kpi-card">
                    <div class="card-title">Online Verbindungen</div>
                    <div class="metric" id="kpi-online">0</div>
                    <div class="muted">Direkt + Agent</div>
                  </article>
                  <article class="kpi-card">
                    <div class="card-title">Gesamt Verbindungen</div>
                    <div class="metric" id="kpi-total">0</div>
                    <div class="muted">Targets + Sessions</div>
                  </article>
                  <article class="kpi-card">
                    <div class="card-title">Letztes Update</div>
                    <div class="metric" id="kpi-updated">-</div>
                    <div class="muted">Auto Refresh alle 30s</div>
                  </article>
                </div>

                <section class="direct-section" id="direct-probe-panel">
                  <div class="section-head">
                    <div class="card-title">Direkte Server (IP)</div>
                    <button class="btn ghost" id="add-direct-server-btn" type="button">Server via IP hinzufügen</button>
                  </div>
                  <p class="panel-message" id="minecraft-message"></p>
                  <div class="minecraft-servers" id="minecraft-servers-list">
                    <div class="empty-state">
                      <div class="title" data-i18n="common.loading_data">Lade Daten...</div>
                      <div class="muted" data-i18n="common.please_wait">Bitte kurz warten.</div>
                    </div>
                  </div>
                </section>

                <p class="panel-message" id="direct-probe-unavailable" hidden></p>

                <section class="mod-panel">
                  <div class="mod-panel-head">
                    <div class="card-title" data-i18n="game_monitor.mod.title">Game Agent Verbindung</div>
                    <button class="btn ghost" id="mod-create-pairing-btn" type="button" data-i18n="game_monitor.mod.create_pairing">
                      Verifizierungscode erzeugen
                    </button>
                  </div>

                  <p class="muted mod-panel-sub" data-i18n="game_monitor.mod.sub">
                    Erstelle einen Pairing-Code im Web und nutze ihn in deinem Agent/Mod. Solange Heartbeats gesendet werden,
                    bleibt die Verbindung online.
                  </p>

                  <div class="mod-pairing-box" id="mod-pairing-box" hidden>
                    <div class="mod-pairing-row">
                      <span class="mod-pairing-label" data-i18n="game_monitor.mod.code_label">Aktueller Code</span>
                      <code class="mod-pairing-code" id="mod-pairing-code">------</code>
                    </div>
                    <div class="mod-pairing-row">
                      <span class="mod-pairing-label" data-i18n="game_monitor.mod.expires_label">Gültig bis</span>
                      <span class="mod-pairing-expiry" id="mod-pairing-expiry">-</span>
                    </div>
                  </div>

                  <p class="panel-message" id="mod-message"></p>

                  <div class="mod-sessions-head">
                    <div class="card-title" data-i18n="game_monitor.mod.sessions_title">Verbundene Mod Sessions</div>
                  </div>
                  <div class="mod-sessions" id="mod-sessions-list">
                    <div class="empty-state">
                      <div class="title" data-i18n="common.loading_data">Lade Daten...</div>
                      <div class="muted" data-i18n="common.please_wait">Bitte kurz warten.</div>
                    </div>
                  </div>
                </section>
              </section>
            </div>
          </main>

          <footer class="site-footer">
            <span class="site-footer-note" data-i18n="common.legal">Rechtliches</span>
            <nav class="site-footer-links" aria-label="Rechtliche Navigation">
              <a href="/nutzungsbedingungen" data-i18n="common.terms">Nutzungsbedingungen</a>
              <a href="/datenschutz" data-i18n="common.privacy">Datenschutz</a>
              <a href="/impressum" data-i18n="common.imprint">Impressum</a>
            </nav>
          </footer>
        </div>
      </div>
    </div>

    <div class="modal-backdrop" id="game-modal" hidden>
      <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="game-modal-title">
        <div class="modal-head">
          <h3 id="game-modal-title">Neues Spiel hinzufügen</h3>
          <button class="btn ghost modal-close" id="game-modal-close" type="button">Schließen</button>
        </div>
        <p class="modal-subtitle">Lege ein neues Spiel an und entscheide, ob die Verbindung per IP oder per Connection Key läuft.</p>

        <form id="game-modal-form" class="game-modal-form" novalidate autocomplete="off">
          <label for="game-modal-name">
            <span>Spielname</span>
            <input id="game-modal-name" type="text" maxlength="60" placeholder="z. B. Minecraft, Rust, CS2" required />
          </label>

          <label for="game-modal-key">
            <span>Spiel-Key (slug)</span>
            <input id="game-modal-key" type="text" maxlength="24" placeholder="z. B. minecraft oder cs2" />
          </label>

          <fieldset class="method-switch">
            <legend>Verbindungstyp</legend>
            <label class="method-option" for="game-mode-ip">
              <input id="game-mode-ip" type="radio" name="game-connection-mode" value="ip" checked />
              <span class="method-indicator" aria-hidden="true"></span>
              <span class="method-copy">
                <strong>Direkt via IP/Host</strong>
                <small>Sofortige Live-Abfrage für Minecraft-Server.</small>
              </span>
            </label>
            <label class="method-option" for="game-mode-key">
              <input id="game-mode-key" type="radio" name="game-connection-mode" value="key" />
              <span class="method-indicator" aria-hidden="true"></span>
              <span class="method-copy">
                <strong>Agent/Mod mit Connection Key</strong>
                <small>Empfohlen für neue Spiele und künftige Integrationen.</small>
              </span>
            </label>
          </fieldset>

          <div class="modal-fields" id="game-modal-ip-fields">
            <label for="game-modal-server-name">
              <span>Servername (optional)</span>
              <input id="game-modal-server-name" type="text" maxlength="80" placeholder="Mein Survival Server" />
            </label>
            <label for="game-modal-host">
              <span>Host oder IP</span>
              <input id="game-modal-host" type="text" maxlength="255" placeholder="play.example.net:25565" />
            </label>
          </div>

          <div class="modal-fields" id="game-modal-key-fields" hidden>
            <p class="muted">Beim Speichern wird direkt ein Connection Key für dein ausgewähltes Spiel erzeugt.</p>
            <div class="mod-pairing-box" id="game-modal-pairing-box" hidden>
              <div class="mod-pairing-row">
                <span class="mod-pairing-label">Connection Key</span>
                <code class="mod-pairing-code" id="game-modal-pairing-code">------</code>
              </div>
              <div class="mod-pairing-row">
                <span class="mod-pairing-label">Gültig bis</span>
                <span class="mod-pairing-expiry" id="game-modal-pairing-expiry">-</span>
              </div>
            </div>
          </div>

          <p class="panel-message" id="game-modal-message"></p>

          <div class="modal-actions">
            <button class="btn ghost" id="game-modal-cancel" type="button">Abbrechen</button>
            <button class="btn primary" id="game-modal-submit" type="submit">Spiel hinzufügen</button>
          </div>
        </form>
      </div>
    </div>

    <script src="/assets/i18n.js"></script>
    <script src="/assets/game-monitor.js"></script>
  </body>
</html>
